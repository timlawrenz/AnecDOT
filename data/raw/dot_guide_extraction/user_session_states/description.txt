User session state machine: anonymous, logged in, active, idle, locked out